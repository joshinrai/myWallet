import{m as L,s as B,C as m,r as d,x as F,j as o,W as S,O as K,n as P,E as H}from"./index.js";import{B as y,T as k,t as D}from"./throttle.js";import{D as V}from"./Dialog.js";import"./List.js";import"./react-is.production.min.js";import"./Modal.js";import"./createSvgIcon.js";const z=L.div`
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: #242424;
  display: flex;
  justify-content: center;
  align-items: center;
  & > div.welcom_content {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
`,O=L.section`
  width: 400px;
  height: 500px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
`,M=B(y)(({theme:a})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:a.palette.getContrastText(m[500]),backgroundColor:m[500],"&:hover":{backgroundColor:m[700]}}));let[$,R]=["",""];const _=new Set(["",null,void 0]),G={pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},J=(a,c)=>({...a,...c}),Q=a=>{const{outerDispatch:c,showDialog:g,walletInstance:v}=a,[x,h]=d.useReducer(J,G),{pswError:i,pswhelperText:j,cfmError:E,cfmhelperText:f}=x,[C,b]=[d.useRef(null),d.useRef(null)],W=F();return o.jsx(V,{onClose:()=>{c({showAddDialog:!1})},open:g,sx:{minWidth:{xs:300,md:300}},children:o.jsxs(O,{children:[o.jsx("h2",{children:"创建新钱包"}),o.jsx(k,{inputRef:C,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:i,helperText:j,onChange:D(l=>{var t;const p=(t=l==null?void 0:l.target)==null?void 0:t.value;$=S.utils.sha3Raw(p);const n=$===R,r=p?n?"":"密码不匹配!":"请填入密码！",e=!!r,s={pswError:e,cfmError:e,pswhelperText:r};n||Object.assign(s,{cfmhelperText:"密码不匹配!"}),h(s)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(k,{inputRef:b,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:E,helperText:f,onChange:D(l=>{var t;const p=(t=l==null?void 0:l.target)==null?void 0:t.value;R=S.utils.sha3Raw(p);const n=$===R,r=p?n?"":"密码不匹配!":"请确认密码！",e=!!r,s={pswError:e,cfmError:e,cfmhelperText:r};n||Object.assign(s,{pswhelperText:"密码不匹配"}),h(s)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(M,{variant:"contained",onClick:async()=>{var l,p;try{const[n,r]=[(l=C==null?void 0:C.current)==null?void 0:l.value,(p=b==null?void 0:b.current)==null?void 0:p.value];let e=!1;if(_.has(n)&&(h({pswError:!0,pswhelperText:"请输入密码！"}),e=!0),_.has(r)&&(h({cfmError:!0,cfmhelperText:"请填入确认密码！"}),e=!0),e||[i,E].some(Boolean))return;await v.create(1),await v.save(R,"myWallet"),W(K(R)),c({showAddDialog:!1})}catch(n){console.log("error is:","color: #f00;",n),h({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},X=d.memo(Q),Y=B(y)(({theme:a})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:a.palette.getContrastText(m[500]),backgroundColor:m[500],"&:hover":{backgroundColor:m[700]}}));let[N,A]=["",""];const I=new Set(["",null,void 0]),Z={fieldError:!1,helperText:"",pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},ee=(a,c)=>({...a,...c}),oe=a=>{const{outerDispatch:c,showDialog:g,accounts:v,walletInstance:x}=a,[h,i]=d.useReducer(ee,Z),{fieldError:j,helperText:E,pswError:f,pswhelperText:C,cfmError:b,cfmhelperText:W}=h,[l,p,n]=[d.useRef(null),d.useRef(null),d.useRef(null)];return o.jsx(V,{onClose:()=>{c({showDialog:!1})},open:g,sx:{minWidth:{xs:300,md:300}},children:o.jsxs(O,{children:[o.jsx("h2",{children:"导入密钥"}),o.jsx(k,{inputRef:l,id:"login_field",label:"私钥",variant:"filled",type:"password",error:j,helperText:E,onChange:D(async r=>{var s;const e=(s=r==null?void 0:r.target)==null?void 0:s.value;if(i({fieldError:!e,helperText:e?"":"请填入私钥！"}),e)try{const t=await v.parseAndValidatePrivateKey(`0x${e}`);console.log("%c 666666666 validRes is:","color: #0f0;",t)}catch{i({fieldError:!0,helperText:"请填入正确的私钥！"})}},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(k,{inputRef:p,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:f,helperText:C,onChange:D(r=>{var u;const e=(u=r==null?void 0:r.target)==null?void 0:u.value;N=S.utils.sha3Raw(e);const s=N===A,t=e?s?"":"密码不匹配!":"请填入密码！",w=!!t,T={pswError:w,cfmError:w,pswhelperText:t};s||Object.assign(T,{cfmhelperText:"密码不匹配!"}),i(T)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(k,{inputRef:n,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:b,helperText:W,onChange:D(r=>{var u;const e=(u=r==null?void 0:r.target)==null?void 0:u.value;A=S.utils.sha3Raw(e);const s=N===A,t=e?s?"":"密码不匹配!":"请确认密码！",w=!!t,T={pswError:w,cfmError:w,cfmhelperText:t};s||Object.assign(T,{pswhelperText:"密码不匹配"}),i(T)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(Y,{variant:"contained",onClick:async()=>{var r,e,s;try{const[t,w,T]=[(r=l==null?void 0:l.current)==null?void 0:r.value,(e=p==null?void 0:p.current)==null?void 0:e.value,(s=n==null?void 0:n.current)==null?void 0:s.value];let u=!1;if(I.has(t)&&(i({fieldError:!0,helperText:"请填入私钥！"}),u=!0),I.has(w)&&(i({pswError:!0,pswhelperText:"请输入密码！"}),u=!0),I.has(T)&&(i({cfmError:!0,cfmhelperText:"请填入确认密码！"}),u=!0),u||[j,f,b].some(Boolean))return;const U=await x.add(`0x${t}`),q=await x.save(`${w}`,"myWallet");console.log("%c 9999999 确定 ...","color: #0f0;",U,q),c({showDialog:!1})}catch(t){console.log("error is:","color: #f00;",t),i({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},re=d.memo(oe),te=B(y)(({theme:a})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:a.palette.getContrastText(m[500]),backgroundColor:m[500],"&:hover":{backgroundColor:m[700]}})),se=B(y)({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",boxShadow:"none",textTransform:"none",fontSize:16,padding:"6px 12px",border:"1px solid",lineHeight:1.5,backgroundColor:"#0063cc",borderColor:"#0063cc",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"#0069d9",borderColor:"#0062cc",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#0062cc",borderColor:"#005cbf"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(0,123,255,.5)"}}),ae={showDialog:!1,showAddDialog:!1},le=(a,c)=>({...a,...c}),ne=a=>{const{accounts:c,walletInstance:g}=a,[v,x]=d.useReducer(le,ae),{showAddDialog:h,showDialog:i}=v,j=P(f=>f.account.password),E=H();return o.jsxs(z,{children:[o.jsxs("div",{className:"welcom_content",children:[o.jsx("h2",{children:"让我们开始创建一个crypto钱包吧！"}),o.jsx("img",{src:"/wallet.svg",alt:"我的钱包"}),o.jsx(te,{variant:"contained",onClick:async()=>{x({showAddDialog:!0}),console.log("%c 111111 创建 新钱包...","color: #0f0;")},children:"创建新钱包"}),o.jsx(se,{variant:"contained",disableRipple:!0,onClick:()=>x({showDialog:!0}),children:"导入现有钱包"}),o.jsx(y,{variant:"contained",sx:{marginTop:"20px"},onClick:async()=>{const f=await g.load(j,"myWallet");console.log("%c 8888888 测试加载钱包 ...","color: #ff0;",f,f.length)},children:"测试加载钱包"}),o.jsx(y,{variant:"contained",sx:{marginTop:"20px"},onClick:async()=>{E("/")},children:"跳转首页"})]}),o.jsx(X,{outerDispatch:x,showDialog:h,walletInstance:g}),o.jsx(re,{outerDispatch:x,showDialog:i,accounts:c,walletInstance:g})]})},fe=d.memo(ne);export{fe as default};
