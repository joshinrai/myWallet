import{f as L,s as S,z as m,r as x,w as F,j as o,W as D,H,G as K}from"./index.js";import{B as y,T as R,t as k}from"./throttle.js";import{D as V}from"./Dialog.js";import"./ButtonBase.js";import"./List.js";import"./react-is.production.min.js";import"./index7.js";import"./Modal.js";import"./useSlotProps.js";import"./createSvgIcon.js";import"./useControlled.js";const P=L.div`
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: #242424;
  display: flex;
  justify-content: center;
  align-items: center;
  & > div.welcom_content {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
`,U=L.section`
  width: 400px;
  height: 500px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
`,z=S(y)(({theme:l})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:l.palette.getContrastText(m[500]),backgroundColor:m[500],"&:hover":{backgroundColor:m[700]}}));let[$,j]=["",""];const _=new Set(["",null,void 0]),G={pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},M=(l,c)=>({...l,...c}),J=l=>{const{outerDispatch:c,showDialog:g,walletInstance:w}=l,[h,f]=x.useReducer(M,G),{pswError:i,pswhelperText:E,cfmError:b,cfmhelperText:B}=h,[C,T]=[x.useRef(null),x.useRef(null)],W=F();return o.jsx(V,{onClose:()=>{c({showAddDialog:!1})},open:g,sx:{minWidth:{xs:300,md:300}},children:o.jsxs(U,{children:[o.jsx("h2",{children:"创建新钱包"}),o.jsx(R,{inputRef:C,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:i,helperText:E,onChange:k(a=>{var t;const p=(t=a==null?void 0:a.target)==null?void 0:t.value;$=D.utils.sha3Raw(p);const n=$===j,r=p?n?"":"密码不匹配!":"请填入密码！",e=!!r,s={pswError:e,cfmError:e,pswhelperText:r};n||Object.assign(s,{cfmhelperText:"密码不匹配!"}),f(s)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(R,{inputRef:T,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:b,helperText:B,onChange:k(a=>{var t;const p=(t=a==null?void 0:a.target)==null?void 0:t.value;j=D.utils.sha3Raw(p);const n=$===j,r=p?n?"":"密码不匹配!":"请确认密码！",e=!!r,s={pswError:e,cfmError:e,cfmhelperText:r};n||Object.assign(s,{pswhelperText:"密码不匹配"}),f(s)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(z,{variant:"contained",onClick:async()=>{var a,p;try{const[n,r]=[(a=C==null?void 0:C.current)==null?void 0:a.value,(p=T==null?void 0:T.current)==null?void 0:p.value];let e=!1;if(_.has(n)&&(f({pswError:!0,pswhelperText:"请输入密码！"}),e=!0),_.has(r)&&(f({cfmError:!0,cfmhelperText:"请填入确认密码！"}),e=!0),e||[i,b].some(Boolean))return;const s=await w.create(1),t=await w.save(j,"myWallet"),d=await w.load(j);console.log("%c 8888888 confirmText is:","color: #ff0;",j),W(H(j)),console.log("%c 9999999 确定 ...","color: #0f0;",s,t,d,d.length),c({showAddDialog:!1})}catch(n){console.log("error is:","color: #f00;",n),f({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},Q=x.memo(J),X=S(y)(({theme:l})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:l.palette.getContrastText(m[500]),backgroundColor:m[500],"&:hover":{backgroundColor:m[700]}}));let[A,I]=["",""];const N=new Set(["",null,void 0]),Y={fieldError:!1,helperText:"",pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},Z=(l,c)=>({...l,...c}),ee=l=>{const{outerDispatch:c,showDialog:g,accounts:w,walletInstance:h}=l,[f,i]=x.useReducer(Z,Y),{fieldError:E,helperText:b,pswError:B,pswhelperText:C,cfmError:T,cfmhelperText:W}=f,[a,p,n]=[x.useRef(null),x.useRef(null),x.useRef(null)];return o.jsx(V,{onClose:()=>{c({showDialog:!1})},open:g,sx:{minWidth:{xs:300,md:300}},children:o.jsxs(U,{children:[o.jsx("h2",{children:"导入密钥"}),o.jsx(R,{inputRef:a,id:"login_field",label:"私钥",variant:"filled",type:"password",error:E,helperText:b,onChange:k(async r=>{var s;const e=(s=r==null?void 0:r.target)==null?void 0:s.value;if(i({fieldError:!e,helperText:e?"":"请填入私钥！"}),e)try{const t=await w.parseAndValidatePrivateKey(`0x${e}`);console.log("%c 666666666 validRes is:","color: #0f0;",t)}catch{i({fieldError:!0,helperText:"请填入正确的私钥！"})}},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(R,{inputRef:p,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:B,helperText:C,onChange:k(r=>{var u;const e=(u=r==null?void 0:r.target)==null?void 0:u.value;A=D.utils.sha3Raw(e);const s=A===I,t=e?s?"":"密码不匹配!":"请填入密码！",d=!!t,v={pswError:d,cfmError:d,pswhelperText:t};s||Object.assign(v,{cfmhelperText:"密码不匹配!"}),i(v)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(R,{inputRef:n,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:T,helperText:W,onChange:k(r=>{var u;const e=(u=r==null?void 0:r.target)==null?void 0:u.value;I=D.utils.sha3Raw(e);const s=A===I,t=e?s?"":"密码不匹配!":"请确认密码！",d=!!t,v={pswError:d,cfmError:d,cfmhelperText:t};s||Object.assign(v,{pswhelperText:"密码不匹配"}),i(v)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(X,{variant:"contained",onClick:async()=>{var r,e,s;try{const[t,d,v]=[(r=a==null?void 0:a.current)==null?void 0:r.value,(e=p==null?void 0:p.current)==null?void 0:e.value,(s=n==null?void 0:n.current)==null?void 0:s.value];let u=!1;if(N.has(t)&&(i({fieldError:!0,helperText:"请填入私钥！"}),u=!0),N.has(d)&&(i({pswError:!0,pswhelperText:"请输入密码！"}),u=!0),N.has(v)&&(i({cfmError:!0,cfmhelperText:"请填入确认密码！"}),u=!0),u||[E,B,T].some(Boolean))return;const q=await h.add(`0x${t}`),O=await h.save(`${d}`,"myWallet");console.log("%c 9999999 确定 ...","color: #0f0;",q,O),c({showDialog:!1})}catch(t){console.log("error is:","color: #f00;",t),i({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},oe=x.memo(ee),re=S(y)(({theme:l})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:l.palette.getContrastText(m[500]),backgroundColor:m[500],"&:hover":{backgroundColor:m[700]}})),te=S(y)({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",boxShadow:"none",textTransform:"none",fontSize:16,padding:"6px 12px",border:"1px solid",lineHeight:1.5,backgroundColor:"#0063cc",borderColor:"#0063cc",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"#0069d9",borderColor:"#0062cc",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#0062cc",borderColor:"#005cbf"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(0,123,255,.5)"}}),se={showDialog:!1,showAddDialog:!1},le=(l,c)=>({...l,...c}),ae=l=>{const{accounts:c,walletInstance:g}=l,[w,h]=x.useReducer(le,se),{showAddDialog:f,showDialog:i}=w,E=K();return o.jsxs(P,{children:[o.jsxs("div",{className:"welcom_content",children:[o.jsx("h2",{children:"让我们开始创建一个crypto钱包吧！"}),o.jsx("img",{src:"/wallet.svg",alt:"我的钱包"}),o.jsx(re,{variant:"contained",onClick:async()=>{h({showAddDialog:!0}),console.log("%c 111111 创建 新钱包...","color: #0f0;")},children:"创建新钱包"}),o.jsx(te,{variant:"contained",disableRipple:!0,onClick:()=>h({showDialog:!0}),children:"导入现有钱包"}),o.jsx(y,{variant:"contained",sx:{marginTop:"20px"},onClick:async()=>{const b=await g.load(D.utils.sha3Raw("test"),"myWallet");console.log("%c 8888888 测试加载钱包 ...","color: #ff0;",b,b.length)},children:"测试加载钱包"}),o.jsx(y,{variant:"contained",sx:{marginTop:"20px"},onClick:async()=>{E("/")},children:"跳转首页"})]}),o.jsx(Q,{outerDispatch:h,showDialog:f,walletInstance:g}),o.jsx(oe,{outerDispatch:h,showDialog:i,accounts:c,walletInstance:g})]})},we=x.memo(ae);export{we as default};
