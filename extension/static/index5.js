import{f as L,s as S,A as f,r as d,w as O,j as o,W as D,K as F,D as P}from"./index.js";import{B as y,T as R,t as k}from"./throttle.js";import{D as V}from"./Dialog.js";import"./List.js";import"./react-is.production.min.js";import"./Modal.js";import"./createSvgIcon.js";const H=L.div`
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: #242424;
  display: flex;
  justify-content: center;
  align-items: center;
  & > div.welcom_content {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
`,U=L.section`
  width: 400px;
  height: 500px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
`,z=S(y)(({theme:s})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:s.palette.getContrastText(f[500]),backgroundColor:f[500],"&:hover":{backgroundColor:f[700]}}));let[$,C]=["",""];const _=new Set(["",null,void 0]),M={pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},G=(s,c)=>({...s,...c}),J=s=>{const{outerDispatch:c,showDialog:w,walletInstance:g}=s,[x,h]=d.useReducer(G,M),{pswError:i,pswhelperText:j,cfmError:b,cfmhelperText:B}=x,[E,T]=[d.useRef(null),d.useRef(null)],W=O();return o.jsx(V,{onClose:()=>{c({showAddDialog:!1})},open:w,sx:{minWidth:{xs:300,md:300}},children:o.jsxs(U,{children:[o.jsx("h2",{children:"创建新钱包"}),o.jsx(R,{inputRef:E,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:i,helperText:j,onChange:k(l=>{var t;const p=(t=l==null?void 0:l.target)==null?void 0:t.value;$=D.utils.sha3Raw(p);const n=$===C,r=p?n?"":"密码不匹配!":"请填入密码！",e=!!r,a={pswError:e,cfmError:e,pswhelperText:r};n||Object.assign(a,{cfmhelperText:"密码不匹配!"}),h(a)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(R,{inputRef:T,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:b,helperText:B,onChange:k(l=>{var t;const p=(t=l==null?void 0:l.target)==null?void 0:t.value;C=D.utils.sha3Raw(p);const n=$===C,r=p?n?"":"密码不匹配!":"请确认密码！",e=!!r,a={pswError:e,cfmError:e,cfmhelperText:r};n||Object.assign(a,{pswhelperText:"密码不匹配"}),h(a)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(z,{variant:"contained",onClick:async()=>{var l,p;try{const[n,r]=[(l=E==null?void 0:E.current)==null?void 0:l.value,(p=T==null?void 0:T.current)==null?void 0:p.value];let e=!1;if(_.has(n)&&(h({pswError:!0,pswhelperText:"请输入密码！"}),e=!0),_.has(r)&&(h({cfmError:!0,cfmhelperText:"请填入确认密码！"}),e=!0),e||[i,b].some(Boolean))return;await g.create(1),await g.save(C,"myWallet"),await g.load(C,"myWallet"),W(F(C)),c({showAddDialog:!1})}catch(n){console.log("error is:","color: #f00;",n),h({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},Q=d.memo(J),X=S(y)(({theme:s})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:s.palette.getContrastText(f[500]),backgroundColor:f[500],"&:hover":{backgroundColor:f[700]}}));let[A,I]=["",""];const N=new Set(["",null,void 0]),Y={fieldError:!1,helperText:"",pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},Z=(s,c)=>({...s,...c}),ee=s=>{const{outerDispatch:c,showDialog:w,accounts:g,walletInstance:x}=s,[h,i]=d.useReducer(Z,Y),{fieldError:j,helperText:b,pswError:B,pswhelperText:E,cfmError:T,cfmhelperText:W}=h,[l,p,n]=[d.useRef(null),d.useRef(null),d.useRef(null)];return o.jsx(V,{onClose:()=>{c({showDialog:!1})},open:w,sx:{minWidth:{xs:300,md:300}},children:o.jsxs(U,{children:[o.jsx("h2",{children:"导入密钥"}),o.jsx(R,{inputRef:l,id:"login_field",label:"私钥",variant:"filled",type:"password",error:j,helperText:b,onChange:k(async r=>{var a;const e=(a=r==null?void 0:r.target)==null?void 0:a.value;if(i({fieldError:!e,helperText:e?"":"请填入私钥！"}),e)try{const t=await g.parseAndValidatePrivateKey(`0x${e}`);console.log("%c 666666666 validRes is:","color: #0f0;",t)}catch{i({fieldError:!0,helperText:"请填入正确的私钥！"})}},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(R,{inputRef:p,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:B,helperText:E,onChange:k(r=>{var u;const e=(u=r==null?void 0:r.target)==null?void 0:u.value;A=D.utils.sha3Raw(e);const a=A===I,t=e?a?"":"密码不匹配!":"请填入密码！",m=!!t,v={pswError:m,cfmError:m,pswhelperText:t};a||Object.assign(v,{cfmhelperText:"密码不匹配!"}),i(v)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(R,{inputRef:n,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:T,helperText:W,onChange:k(r=>{var u;const e=(u=r==null?void 0:r.target)==null?void 0:u.value;I=D.utils.sha3Raw(e);const a=A===I,t=e?a?"":"密码不匹配!":"请确认密码！",m=!!t,v={pswError:m,cfmError:m,cfmhelperText:t};a||Object.assign(v,{pswhelperText:"密码不匹配"}),i(v)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),o.jsx(X,{variant:"contained",onClick:async()=>{var r,e,a;try{const[t,m,v]=[(r=l==null?void 0:l.current)==null?void 0:r.value,(e=p==null?void 0:p.current)==null?void 0:e.value,(a=n==null?void 0:n.current)==null?void 0:a.value];let u=!1;if(N.has(t)&&(i({fieldError:!0,helperText:"请填入私钥！"}),u=!0),N.has(m)&&(i({pswError:!0,pswhelperText:"请输入密码！"}),u=!0),N.has(v)&&(i({cfmError:!0,cfmhelperText:"请填入确认密码！"}),u=!0),u||[j,B,T].some(Boolean))return;const q=await x.add(`0x${t}`),K=await x.save(`${m}`,"myWallet");console.log("%c 9999999 确定 ...","color: #0f0;",q,K),c({showDialog:!1})}catch(t){console.log("error is:","color: #f00;",t),i({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},oe=d.memo(ee),re=S(y)(({theme:s})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:s.palette.getContrastText(f[500]),backgroundColor:f[500],"&:hover":{backgroundColor:f[700]}})),te=S(y)({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",boxShadow:"none",textTransform:"none",fontSize:16,padding:"6px 12px",border:"1px solid",lineHeight:1.5,backgroundColor:"#0063cc",borderColor:"#0063cc",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"#0069d9",borderColor:"#0062cc",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#0062cc",borderColor:"#005cbf"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(0,123,255,.5)"}}),se={showDialog:!1,showAddDialog:!1},ae=(s,c)=>({...s,...c}),le=s=>{const{accounts:c,walletInstance:w}=s,[g,x]=d.useReducer(ae,se),{showAddDialog:h,showDialog:i}=g,j=P();return o.jsxs(H,{children:[o.jsxs("div",{className:"welcom_content",children:[o.jsx("h2",{children:"让我们开始创建一个crypto钱包吧！"}),o.jsx("img",{src:"/wallet.svg",alt:"我的钱包"}),o.jsx(re,{variant:"contained",onClick:async()=>{x({showAddDialog:!0}),console.log("%c 111111 创建 新钱包...","color: #0f0;")},children:"创建新钱包"}),o.jsx(te,{variant:"contained",disableRipple:!0,onClick:()=>x({showDialog:!0}),children:"导入现有钱包"}),o.jsx(y,{variant:"contained",sx:{marginTop:"20px"},onClick:async()=>{const b=await w.load(D.utils.sha3Raw("test"),"myWallet");console.log("%c 8888888 测试加载钱包 ...","color: #ff0;",b,b.length)},children:"测试加载钱包"}),o.jsx(y,{variant:"contained",sx:{marginTop:"20px"},onClick:async()=>{j("/")},children:"跳转首页"})]}),o.jsx(Q,{outerDispatch:x,showDialog:h,walletInstance:w}),o.jsx(oe,{outerDispatch:x,showDialog:i,accounts:c,walletInstance:w})]})},he=d.memo(le);export{he as default};
