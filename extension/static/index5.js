import{m as V,s as B,C as f,r as d,x as P,E as O,j as r,W as E,O as H}from"./index.js";import{B as S,T as C,t as y}from"./throttle.js";import{D as U}from"./Dialog.js";import"./List.js";import"./react-is.production.min.js";import"./Modal.js";import"./createSvgIcon.js";const z=V.div`
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: #242424;
  display: flex;
  justify-content: center;
  align-items: center;
  & > div.welcom_content {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
`,q=V.section`
  width: 400px;
  height: 500px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
`,M=B(S)(({theme:a})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:a.palette.getContrastText(f[500]),backgroundColor:f[500],"&:hover":{backgroundColor:f[700]}}));let[N,j]=["",""];const L=new Set(["",null,void 0]),G={pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},J=(a,c)=>({...a,...c}),Q=a=>{const{outerDispatch:c,showDialog:b,walletInstance:T}=a,[h,x]=d.useReducer(J,G),{pswError:i,pswhelperText:R,cfmError:D,cfmhelperText:k}=h,[v,w]=[d.useRef(null),d.useRef(null)],W=P(),$=O();return r.jsx(U,{onClose:()=>{c({showAddDialog:!1})},open:b,sx:{minWidth:{xs:300,md:300}},children:r.jsxs(q,{children:[r.jsx("h2",{children:"创建新钱包"}),r.jsx(C,{inputRef:v,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:i,helperText:R,onChange:y(l=>{var t;const p=(t=l==null?void 0:l.target)==null?void 0:t.value;N=E.utils.sha3Raw(p);const n=N===j,o=p?n?"":"密码不匹配!":"请填入密码！",e=!!o,s={pswError:e,cfmError:e,pswhelperText:o};n||Object.assign(s,{cfmhelperText:"密码不匹配!"}),x(s)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),r.jsx(C,{inputRef:w,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:D,helperText:k,onChange:y(l=>{var t;const p=(t=l==null?void 0:l.target)==null?void 0:t.value;j=E.utils.sha3Raw(p);const n=N===j,o=p?n?"":"密码不匹配!":"请确认密码！",e=!!o,s={pswError:e,cfmError:e,cfmhelperText:o};n||Object.assign(s,{pswhelperText:"密码不匹配"}),x(s)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),r.jsx(M,{variant:"contained",onClick:async()=>{var l,p;try{const[n,o]=[(l=v==null?void 0:v.current)==null?void 0:l.value,(p=w==null?void 0:w.current)==null?void 0:p.value];let e=!1;if(L.has(n)&&(x({pswError:!0,pswhelperText:"请输入密码！"}),e=!0),L.has(o)&&(x({cfmError:!0,cfmhelperText:"请填入确认密码！"}),e=!0),e||[i,D].some(Boolean))return;await T.create(1),await T.save(j,"myWallet"),W(H(j)),c({showAddDialog:!1}),$("/")}catch(n){console.log("error is:","color: #f00;",n),x({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},X=d.memo(Q),Y=B(S)(({theme:a})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:a.palette.getContrastText(f[500]),backgroundColor:f[500],"&:hover":{backgroundColor:f[700]}}));let[A,I]=["",""];const _=new Set(["",null,void 0]),Z={fieldError:!1,helperText:"",pswError:!1,pswhelperText:"",cfmError:!1,cfmhelperText:""},ee=(a,c)=>({...a,...c}),oe=a=>{const{outerDispatch:c,showDialog:b,accounts:T,walletInstance:h}=a,[x,i]=d.useReducer(ee,Z),{fieldError:R,helperText:D,pswError:k,pswhelperText:v,cfmError:w,cfmhelperText:W}=x,$=O(),[l,p,n]=[d.useRef(null),d.useRef(null),d.useRef(null)];return r.jsx(U,{onClose:()=>{c({showDialog:!1})},open:b,sx:{minWidth:{xs:300,md:300}},children:r.jsxs(q,{children:[r.jsx("h2",{children:"导入密钥"}),r.jsx(C,{inputRef:l,id:"login_field",label:"私钥",variant:"filled",type:"password",error:R,helperText:D,onChange:y(async o=>{var s;const e=(s=o==null?void 0:o.target)==null?void 0:s.value;if(i({fieldError:!e,helperText:e?"":"请填入私钥！"}),e)try{const t=await T.parseAndValidatePrivateKey(`0x${e}`);console.log("%c 666666666 validRes is:","color: #0f0;",t)}catch{i({fieldError:!0,helperText:"请填入正确的私钥！"})}},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),r.jsx(C,{inputRef:p,id:"password_field",label:"设置密码",variant:"filled",type:"password",error:k,helperText:v,onChange:y(o=>{var u;const e=(u=o==null?void 0:o.target)==null?void 0:u.value;A=E.utils.sha3Raw(e);const s=A===I,t=e?s?"":"密码不匹配!":"请填入密码！",m=!!t,g={pswError:m,cfmError:m,pswhelperText:t};s||Object.assign(g,{cfmhelperText:"密码不匹配!"}),i(g)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),r.jsx(C,{inputRef:n,id:"confirm_field",label:"确认密码",variant:"filled",type:"password",error:w,helperText:W,onChange:y(o=>{var u;const e=(u=o==null?void 0:o.target)==null?void 0:u.value;I=E.utils.sha3Raw(e);const s=A===I,t=e?s?"":"密码不匹配!":"请确认密码！",m=!!t,g={pswError:m,cfmError:m,cfmhelperText:t};s||Object.assign(g,{pswhelperText:"密码不匹配"}),i(g)},200),sx:{width:"300px",background:"#fffb8f",borderRadius:"5px"}}),r.jsx(Y,{variant:"contained",onClick:async()=>{var o,e,s;try{const[t,m,g]=[(o=l==null?void 0:l.current)==null?void 0:o.value,(e=p==null?void 0:p.current)==null?void 0:e.value,(s=n==null?void 0:n.current)==null?void 0:s.value];let u=!1;if(_.has(t)&&(i({fieldError:!0,helperText:"请填入私钥！"}),u=!0),_.has(m)&&(i({pswError:!0,pswhelperText:"请输入密码！"}),u=!0),_.has(g)&&(i({cfmError:!0,cfmhelperText:"请填入确认密码！"}),u=!0),u||[R,k,w].some(Boolean))return;const F=await h.add(`0x${t}`),K=await h.save(E.utils.sha3Raw(m),"myWallet");console.log("%c 9999999 确定 ...","color: #0f0;",F,K),c({showDialog:!1}),$("/")}catch(t){console.log("error is:","color: #f00;",t),i({fieldError:!0,helperText:"请填入正确私钥！"})}},children:"确定"})]})})},re=d.memo(oe),te=B(S)(({theme:a})=>({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",color:a.palette.getContrastText(f[500]),backgroundColor:f[500],"&:hover":{backgroundColor:f[700]}})),se=B(S)({width:"300px",height:"50px",marginTop:"10px",borderRadius:"25px",boxShadow:"none",textTransform:"none",fontSize:16,padding:"6px 12px",border:"1px solid",lineHeight:1.5,backgroundColor:"#0063cc",borderColor:"#0063cc",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"#0069d9",borderColor:"#0062cc",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#0062cc",borderColor:"#005cbf"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(0,123,255,.5)"}}),ae={showDialog:!1,showAddDialog:!1},le=(a,c)=>({...a,...c}),ne=a=>{const{accounts:c,walletInstance:b}=a,[T,h]=d.useReducer(le,ae),{showAddDialog:x,showDialog:i}=T;return r.jsxs(z,{children:[r.jsxs("div",{className:"welcom_content",children:[r.jsx("h2",{children:"让我们开始创建一个crypto钱包吧！"}),r.jsx("img",{src:"/wallet.svg",alt:"我的钱包"}),r.jsx(te,{variant:"contained",onClick:async()=>{h({showAddDialog:!0}),console.log("%c 111111 创建 新钱包...","color: #0f0;")},children:"创建新钱包"}),r.jsx(se,{variant:"contained",disableRipple:!0,onClick:()=>h({showDialog:!0}),children:"导入现有钱包"})]}),r.jsx(X,{outerDispatch:h,showDialog:x,walletInstance:b}),r.jsx(re,{outerDispatch:h,showDialog:i,accounts:c,walletInstance:b})]})},fe=d.memo(ne);export{fe as default};
